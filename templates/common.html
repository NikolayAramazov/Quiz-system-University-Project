<!DOCTYPE html>
<html lang="en">
<head>
  {% load static %}
  <meta charset="UTF-8">
  <title>{% block title %}Home Page{% endblock %}</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="{% static 'css/main.css' %}?v=1">
  <link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono&display=swap" rel="stylesheet">
</head>
<body class="d-flex flex-column min-vh-100">

  <!-- Navbar -->
  <nav class="nav-bar d-flex justify-content-between align-items-center p-3 bg-dark">
    <!-- Left: Home Button -->
        <a href="{% url 'common:home' %}">
            <img src={% static 'images/home_btn.png' %} alt="Home" style="width: 90px;">

        </a>

    <!-- Right: Sign in / Profile / Logout -->
    <div class="d-flex align-items-center">
        {% if user.is_authenticated %}
            <form action="{% url 'accounts:logout' %}" method="post" class="d-inline me-2">
                {% csrf_token %}
                <button type="submit" class="btn btn-outline-light">Sign out</button>
            </form>
            <a href="{% url 'accounts:profile' %}">
                <img src="{{ user.profile.profile_img.url }}"
                     alt="Profile"
                     style="border: 1px solid #00ff88; border-radius: 50%; padding: 5px; width: 55px;">
            </a>
        {% else %}
            <a href="{% url 'accounts:sign_in' %}">
                <button type="button" class="btn btn-outline-light">Sign in</button>
            </a>
        {% endif %}
    </div>
</nav>

  {% if request.path == '/' %}

  <!-- Hero Section -->
<section class="hero d-flex align-items-center">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-7 hero-copy">
        <h1 class="display-4"><span class="green">Linux</span> & Cybersecurity labs â€” learn by doing</h1>
        <p class="lead text-muted">Handsâ€‘on rooms, guided tasks, terminal-first exercises and real-world scenarios.</p>
        <div class="mt-4">
            {% if user.is_authenticated %}
                <a href="{% url 'accounts:profile' %}" class="btn btn-cta btn-lg mr-2">Get Started</a>
                {% else %}
                <a href="{% url 'accounts:sign_in' %}" class="btn btn-cta btn-lg mr-2">Get Started</a>
            {% endif %}
          <a href="{% url 'courses:view_courses' %}" class="btn btn-outline-light btn-lg">Browse Courses</a>
        </div>
      </div>

      <div class="col-md-5 hero-image d-none d-md-block">
        <div class="term-card">
          <img src={% static 'images/linux-security-tools-featured-image.jpg' %} alt="terminal" />
          <div class="term-overlay">
            <pre><code>$ ssh student@lab
$ sudo apt update
$ ./exploit --target 10.10.0.5</code></pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


  <!-- Features Section -->
  <section id="features" class="py-5">
    <div class="container">
      <div class="row text-center">
        <div class="col-md-4 mb-4">
          <i class="fa-solid fa-terminal fa-2x green mb-2"></i>
          <h5>Browser Terminal</h5>
          <p class="text-muted small">Full shell in your browser â€” no local setup required.</p>
        </div>
        <div class="col-md-4 mb-4">
          <i class="fa-solid fa-shield-check fa-2x green mb-2"></i>
          <h5>Guided & Unlocked Labs</h5>
          <p class="text-muted small">Step-by-step for beginners and unlocked CTF rooms for pros.</p>
        </div>
        <div class="col-md-4 mb-4">
          <i class="fa-solid fa-certificate fa-2x green mb-2"></i>
          <h5>Cert Pathways</h5>
          <p class="text-muted small">Track progress and earn certificates for completed learning paths.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Courses Section -->
  <section id="courses" class="py-5 bg-darkish">
    <div class="container">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="mb-0">Popular courses</h2>
        <a href="" class="text-muted">View all â†’</a>
      </div>

      <div class="row">
        {% for course in courses %}
          <div class="col-md-6 col-lg-3 mb-4">
            <div class="course-card h-100">
              <div class="course-thumb" style="background-image: url('{{ course.thumbnail.url }}');"></div>
              <div class="p-3">
                <h5 class="mb-1">{{ course.title }}</h5>
                <p class="small text-muted mb-2">{{ course.level }} â€¢ {{ course.duration }}</p>

                {% if user.is_authenticated %}

                  {% if course.prerequisite and course.prerequisite.id not in completed_courses_ids %}
                    <button class="btn btn-sm btn-secondary" disabled>
                      Locked ðŸ”’
                    </button>
                    <small class="text-warning d-block mt-1">
                      Complete "{{ course.prerequisite.title }}" first
                    </small>
                  {% else %}
                    <a href="{% url 'courses:course_quiz' slug=course.slug %}" class="btn btn-sm btn-outline-light">
                      Open
                    </a>
                  {% endif %}

                {% else %}
                  <a href="{% url 'accounts:sign_in' %}" class="btn btn-sm btn-outline-light">Open</a>
                {% endif %}

                {% if course in completed_courses %}
                  <i class="fa-solid fa-check" style="color: #00ff88; font-size: x-large"></i>
                {% endif %}
              </div>
            </div>
          </div>
        {% empty %}
          <p class="text-muted">No courses available yet.</p>
        {% endfor %}
      </div>
    </div>
  </section>

  <!-- How It Works -->
  <section id="how" class="py-5">
    <div class="container">
      <h3 class="text-center mb-4">How it works</h3>
      <div class="row">
        <div class="col-md-4 text-center mb-3">
          <div class="step">1</div>
          <h6>Choose a lab</h6>
          <p class="small text-muted">Pick a guided or freeform environment.</p>
        </div>
        <div class="col-md-4 text-center mb-3">
          <div class="step">2</div>
          <h6>Launch the terminal</h6>
          <p class="small text-muted">Connect to a browser shell or VM.</p>
        </div>
        <div class="col-md-4 text-center mb-3">
          <div class="step">3</div>
          <h6>Complete tasks</h6>
          <p class="small text-muted">Finish levels, earn points, unlock rooms.</p>
        </div>
      </div>
    </div>
  </section>

  {% endif %}

<div class="flex-fill">
  {% block content %}
  {% endblock %}
</div>

<footer class="site-footer py-4">
  <div class="container d-flex flex-column flex-md-row justify-content-between align-items-center">
    <div class="footer-left text-muted">
      &copy; Company
    </div>
  </div>
</footer>


</body>
</html>
